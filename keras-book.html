---
permalink: /keras-book
---
<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Keras 3 - The Comprehensive Guide to Deep Learning with the Keras API and Python | Book Resources Page
    </title>

    <meta name="description"
        content="Keras 3: The Comprehensive Guide to Deep Learning with the Keras API and Python. Explore practical deep learning concepts, hands-on projects, and resources for mastering Keras, neural networks, CNNs, transformers, and more." />
    <meta name="keywords"
        content="Keras, deep learning, machine learning, neural networks, Python, gradient descent, classification, regularization, convolutional neural networks, CNN, functional API, transformers, transfer learning, code examples, tutorials, book, Mohammad Nauman, recluze" />

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@100..900&display=swap" rel="stylesheet">

    <style>
        /* Custom styles for smooth transition */
        .chapter-content {
            max-height: 0;
            overflow: hidden;
            transition:
                max-height 0.5s ease-out,
                padding 0.5s ease-out;
            padding-left: 1rem;
            /* Indent content */
            padding-right: 1rem;
        }

        .chapter-content.open {
            /* Increased max-height slightly to accommodate potentially taller content */
            max-height: 900px;
            padding-top: 1rem;
            padding-bottom: 1rem;
            transition:
                max-height 0.5s ease-in,
                padding 0.5s ease-in;
        }

        .chevron-icon {
            transition: transform 0.3s ease;
        }

        .chevron-icon.rotated {
            transform: rotate(90deg);
        }

        /* Basic styling for the search input */
        .search-input {
            border: 1px solid #e2e8f0;
            /* Tailwind gray-300 */
            border-radius: 0.375rem;
            /* Tailwind rounded-md */
            padding: 0.5rem 0.75rem;
            font-size: 0.875rem;
            /* Tailwind text-sm */
        }

        /* Button styling */
        .action-button {
            display: flex;
            align-items: center;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            /* rounded-md */
            font-weight: 500;
            /* medium */
            transition: background-color 0.2s ease;
        }

        .primary-button {
            background-color: #1f2937;
            /* gray-800 */
            color: white;
            justify-content: center;
            /* Center text/icon */
        }

        .primary-button:hover {
            background-color: #374151;
            /* gray-700 */
        }

        .secondary-button {
            background-color: #e5e7eb;
            /* gray-200 */
            color: #1f2937;
            /* gray-800 */
            border: 1px solid #d1d5db;
            /* gray-300 */
            justify-content: center;
            /* Center text/icon */
        }

        .secondary-button:hover {
            background-color: #d1d5db;
            /* gray-300 */
        }

        .resource-button {
            background-color: #f3f4f6;
            /* gray-100 */
            color: #374151;
            /* gray-700 */
            border: 1px solid #e5e7eb;
            /* gray-200 */
            font-size: 0.875rem;
            /* text-sm */
            justify-content: flex-start;
            /* Align text/icon left */
            text-align: left;
            /* Responsive width handled by utility classes */
        }

        .resource-button:hover {
            background-color: #e5e7eb;
            /* gray-200 */
        }

        /* Add margin to block buttons */
        .resource-button.block {
            margin-bottom: 0.5rem;
            /* Tailwind mb-2 */
        }

        /* Remove margin from the last block button in a group */
        .resource-button.block:last-child {
            margin-bottom: 0;
        }

        .book-blurb,
        .about-author {
            margin-bottom: 1em;
            font-size: 1.05rem;
            color: var(--secondary-color);
            line-height: 1.8;
            max-width: 95%;
            /* letter-spacing: 0.01em; */
            text-rendering: optimizeLegibility;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .book-blurb p,
        .about-author p {
            margin-bottom: 0.5em;
        }

        .notebook-icon {
            margin-right: 1em;
        }

        .book-title {
            font-size: 1.05rem;
            /* font-family: Verdana, Geneva, Tahoma, sans-serif; */
            text-rendering: optimizeLegibility;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .intext-link { 
            color: #1f2937;
            /* gray-800 */
            /* text-decoration: underline; */
            border-bottom: 1px dashed #1f2937;
        }

        header,
        body {
            font-family: "Roboto Slab", serif;
        }
    </style>
</head>

<body class="bg-gray-50 font-sans text-gray-800">
    <div class="container mx-auto p-2 md:p-8 max-w-4xl">
        <header class="mx-5">
            <h1 class="text-3xl md:text-4xl font-bold mb-2 text-gray-900 book-title">
                 Keras 3
            </h1>
            <p class="text-lg text-gray-600 mb-4 book-title">
                The Comprehensive Guide to Deep Learning with the Keras API and Python
            </p>
        </header>
        <section class="mb-12 bg-white rounded-lg shadow-sm border border-gray-200 p-6">

            <!-- Stars  -->
            <!-- <div class="flex items-center mb-6 text-yellow-500">
                <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                class="fas fa-star-half-alt"></i>
                <span class="ml-2 text-gray-600 text-sm">4.7 (42 reviews)</span>
            </div> -->
            <!-- <hr class="my-4" />  -->
            <div class="flex flex-col md:flex-row gap-12 book-blurb">
              <!-- Left column: text -->
              <div class="md:w-2/3">
                <p>
                  This book lays the foundation for practical deep
                  learning development, beginning with core machine
                  learning concepts and gradually building toward
                  sophisticated neural network architectures. Whether
                  you're a beginner seeking to understand the fundamentals
                  or an experienced practitioner looking to stay ahead of
                  the curve, this guide offers clear explanations,
                  practical code examples, and hands-on projects that will
                  enhance your deep learning journey.
                </p>
                <p>
                  Throughout our journey in this book, you'll encounter
                  snippets of code that demonstrate key concepts. Don't
                  worry if some of the code examples in the first few
                  chapters look complex or unfamiliar -- they're not meant
                  to be fully understood right away. Think of them as
                  windows into the practical world of machine learning,
                  giving you glimpses of how theoretical concepts
                  transform into working solutions.
                </p>
                <p>
                  As we progress through the book, we'll dive into the
                  internals of Keras -- the powerful tool that makes much
                  of this code possible. That's when these initial code
                  examples will start to click into place, like puzzle
                  pieces finally finding their home. You'll begin to
                  understand not just what the code does, but why it's
                  written that way.
                </p>
              </div>
              <!-- Right column: image placeholder -->
              <div class="md:w-1/4 flex justify-center items-start">
                <!-- Replace src with your image path -->
                <img src="/assets/images/book-cover-3d.jpg" alt="Keras 3 Book Cover" class="rounded-lg shadow-mdx max-w-full h-auto" />
              </div>
            </div>
            <div class="flex space-x-4">
              <a href="http://rheinwerk-computing.com/6142">
                <button class="action-button primary-button inline-flex">
                    <i class="fas fa-book mr-2"></i> Get the Book
                </button>
              </a>
              <!-- <a href="http://rheinwerk-computing.com/6142">
                <button class="action-button primary-button inline-flex">
                    <i class="fas fa-book mr-2"></i>Download Slide Deck
                </button>
              </a> -->
                <!-- <button class="action-button secondary-button inline-flex">
                    <i class="fas fa-eye mr-2"></i> Preview
                </button> -->
            </div>
        </section>

       <!-- Slides section begin -->
        <section class="p-6 pb-1 my-5 bg-white rounded-lg shadow-sm border border-gray-200">
            <h2 class="text-2xl font-semibold mb-4 text-gray-900 flex items-center">
                Download Instructor Slides 
            </h2>
            <div class="flex items-center space-x-4">
                <!-- <div class="w-16 h-16 bg-gray-300 rounded-full flex-shrink-0"></div> -->
                <div>
              
                    <div class="flex flex-col md:flex-row gap-12">
                      <!-- Left column: text -->
                      <div class="md:w-1/2 text-sm text-gray-700 mt-1 about-author">
                        <p>
                          You can download the detailed Powerpoint slide decks for all chapters of the book from the
                          <a class='intext-link' href="https://github.com/recluze/keras-book-slides">Github repository here.</a>
                          These slides are custom designed to complement the book's content, include carefully curated bullet points, figures and code listings from the books  and can be a valuable resource for instructors and learners alike. 
                        </p>
                        <p>
                          Please see the last slide of slide decks for copyrights and permissions for use.
                        </p>
                      </div>
                      <!-- Right column: image placeholder -->
                      <div class="md:w-1/2 flex justify-center items-start">
                        <!-- Replace src with your image path -->
                        <img src="/assets/images/slides-shot.png" alt="Slides Screenshot" class="max-w-full h-auto" />
                      </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Slides section end  -->

        <!-- Chapters section begin  -->
        <section class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
            <div class="flex justify-between items-center mb-6 flex-wrap gap-4">
                <h2 class="text-2xl font-semibold text-gray-900 flex items-center">
                    <i class="fas fa-list-ul mr-3 text-gray-500"></i> Table
                    of Contents / Resources
                </h2>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <input type="text" id="chapterSearch" placeholder="Search chapters..."
                            class="search-input pl-8" />
                        <i class="fas fa-search absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                    </div>
                    <button id="expandAllBtn" class="action-button secondary-button text-sm inline-flex">
                        Expand All
                    </button>
                </div>
            </div>

            <div id="tocList" class="space-y-2">
                <div class="chapter-item border border-gray-200 rounded-lg overflow-hidden">
                    <button
                        class="chapter-header w-full flex justify-between items-center p-4 bg-gray-50 hover:bg-gray-100 focus:outline-none text-left"
                        aria-expanded="false">
                        <span class="font-medium text-gray-700"><span class="mr-2 text-gray-500">1</span>
                            Introduction</span>
                        <i class="fas fa-chevron-right chevron-icon text-gray-500"></i>
                    </button>
                    <div class="chapter-content bg-white">
                        <p class="text-gray-600 text-sm mb-4">
                            In this chapter, we'll explore some success stories of deep learning, discuss why Keras is
                            the ideal framework for learning this impressive technology, what you can expect from this
                            book's comprehensive journey, and how to use it most effectively to build your expertise.
                        </p>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Sections:
                        </h4>
                        <ul class="list-disc list-inside text-sm text-gray-600 mb-4 space-y-1">
                            <li>1.1	Overview of Deep Learning</li>
                            <li>1.2	Why Keras</li>
                            <li>1.3	The Structure of This Book</li>
                            <li>1.4	How to Use This Book</li>
                        </ul>
                        <!-- <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Resources:
                        </h4>
                        <div>
                            <button class="action-button resource-button block w-full md:w-1/2">
                                Read Chapter
                            </button>
                            <button class="action-button resource-button block w-full md:w-1/2">
                                Watch Tutorial
                            </button>
                            <button class="action-button resource-button block w-full md:w-1/2">
                                Code Examples
                            </button>
                        </div> -->
                    </div>
                </div>

                <!-- start of Chapter  -->
                <div class="chapter-item border border-gray-200 rounded-lg overflow-hidden">
                    <button
                        class="chapter-header w-full flex justify-between items-center p-4 bg-gray-50 hover:bg-gray-100 focus:outline-none text-left"
                        aria-expanded="false">
                        <span class="font-medium text-gray-700"><span class="mr-2 text-gray-500">2</span>
                            Introduction to the Core of Machine
                            Learning</span>
                        <i class="fas fa-chevron-right chevron-icon text-gray-500"></i>
                    </button>
                    <div class="chapter-content bg-white">
                        <p class="text-gray-600 text-sm mb-4">
                            At its core, machine learning is about finding
                            patterns in data and using them to make
                            decisions. In this chapter, we'll explore the
                            fundamental ways machines can learn - through
                            direct instruction with examples, by discovering
                            patterns on their own, or through trial and
                            error. We'll see how these approaches mirror
                            learning in the natural world, and we'll begin
                            to understand the powerful systems that make
                            this learning possible. By the end, you'll be
                            ready to start experimenting with these ideas
                            yourself.
                        </p>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Subsections:
                        </h4>
                        <ul class="list-disc list-inside text-sm text-gray-600 mb-4 space-y-1">
                            <li>What is Machine Learning</li>
                            <li>Types of Machine Learning</li>
                            <li>The Magic Sauce: Reinforcement Learning</li>
                            <li>Basics of Neural Networks</li>
                            <li>Setting Up Your Environment</li>
                            <li>Summary</li>
                        </ul>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Resources:
                        </h4>
                        <div>
                            <a href="https://colab.research.google.com/drive/1uwFUEbJ8tKv5-4weNdvya8WdWXb2snfj?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                02-01-mnist-basic
                            </a>
                        </div>
                    </div>
                </div>
                <!-- Enf of Chapter  -->

                <!-- start of Chapter  -->
                <div class="chapter-item border border-gray-200 rounded-lg overflow-hidden">
                    <button
                        class="chapter-header w-full flex justify-between items-center p-4 bg-gray-50 hover:bg-gray-100 focus:outline-none text-left"
                        aria-expanded="false">
                        <span class="font-medium text-gray-700"><span class="mr-2 text-gray-500">3</span>
                            Fundamentals of Gradient Descent
                        </span>
                        <i class="fas fa-chevron-right chevron-icon text-gray-500"></i>
                    </button>
                    <div class="chapter-content bg-white">
                        <p class="text-gray-600 text-sm mb-4">
                            Gradient descent is the cornerstone of modern
                            machine learning, powering everything from
                            simple predictions to complex AI systems. In
                            this chapter, we'll build this fundamental
                            algorithm from the ground up. This deep,
                            foundational knowledge will serve as a guide to
                            help you recognize how even the most advanced
                            models are built on top of these guiding
                            principles.
                        </p>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Subsections:
                        </h4>
                        <ul class="list-disc list-inside text-sm text-gray-600 mb-4 space-y-1">
                            <li>Understanding Gradient Descent</li>
                            <li>Types of Gradient Descent: Batch, Stochastic, Mini-Batch</li>
                            <li>Learning Rate and Optimization</li>
                            <li>Implementing Graident Descent in Code</li>
                            <li>Summary</li>
                        </ul>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Resources:
                        </h4>
                        <div>
                            <a href="https://colab.research.google.com/drive/1-6_iI3J9OQi8d-rH6BBsXXBU_9EaFcCV?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                03-01-SGD-scratch
                            </a>
                            <a href="https://colab.research.google.com/drive/1S2xDJkiI_ZfAkfWqJ8uia3s7QcdCiPqq?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                03-02-SGD-keras
                            </a>
                            <a href="https://recluze.net/kb/03-mse-fit-demo.html" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-earth-asia notebook-icon"></i>
                                03-03-mse-fit-demo
                            </a>
                        </div>
                    </div>
                </div>
                <!-- Enf of Chapter  -->
                <!-- start of Chapter  -->
                <div class="chapter-item border border-gray-200 rounded-lg overflow-hidden">
                    <button
                        class="chapter-header w-full flex justify-between items-center p-4 bg-gray-50 hover:bg-gray-100 focus:outline-none text-left"
                        aria-expanded="false">
                        <span class="font-medium text-gray-700"><span class="mr-2 text-gray-500">4</span>
                            Classification through Gradient Descent
                        </span>
                        <i class="fas fa-chevron-right chevron-icon text-gray-500"></i>
                    </button>
                    <div class="chapter-content bg-white">
                        <p class="text-gray-600 text-sm mb-4">
                            In this chapter, we will build increasingly sophisticated models on top of our current
                            understanding of regression. We will discover how to make yes-no decisions using logistic
                            regression and then expand our capabilities to handle multiple categories simultaneously.
                            Along the way, we will encounter essential concepts like softmax probabilities and
                            cross-entropy loss. Through this journey, we will see how the humble task of drawing lines
                            through data points evolves into systems capable of making nuanced decisions across multiple
                            categories, setting the stage for more advanced applications in neural networks.
                        </p>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Subsections:
                        </h4>
                        <ul class="list-disc list-inside text-sm text-gray-600 mb-4 space-y-1">
                            <li>Classification Basics</li>
                            <li>Non-Linear Relationships and Neural Networks</li>
                            <li>Binary vs Multi-Class Classification</li>
                            <li>Loss Functions: Cross-Entropy</li>
                            <li>Building a Classifier with Gradient Descent</li>
                            <li>Summary</li>
                        </ul>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Resources:
                        </h4>
                        <div>
                            <a href="https://colab.research.google.com/drive/1XyrkNEROBSVFFCkLM6Hvu9ctBcA4hC17?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                04-01-classification-model
                            </a>
                        </div>
                    </div>
                </div>
                <!-- Enf of Chapter  -->

                <!-- start of Chapter  -->
                <div class="chapter-item border border-gray-200 rounded-lg">
                    <button
                        class="chapter-header w-full flex justify-between items-center p-4 bg-gray-50 hover:bg-gray-100 focus:outline-none text-left"
                        aria-expanded="false">
                        <span class="font-medium text-gray-700"><span class="mr-2 text-gray-500">5</span>
                            Deep Dive Into Keras
                        </span>
                        <i class="fas fa-chevron-right chevron-icon text-gray-500"></i>
                    </button>
                    <div class="chapter-content bg-white">
                        <p class="text-gray-600 text-sm mb-4">
                            In this chapter, we will finally dive deep into Keras. After examining the core technologies
                            that power Keras, we will construct a practical image classifier that distinguishes between
                            cats and dogs. Through this hands-on project, we will implement each essential component of
                            the machine learning workflow: data preparation, model design, training, evaluation with
                            multiple metrics, and model preservation. By the chapter's end, you will have mastered the
                            fundamental patterns that form the foundation for all your future deep-learning projects.
                        </p>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Subsections:
                        </h4>
                        <ul class="list-disc list-inside text-sm text-gray-600 mb-4 space-y-1">
                            <li>Introduction to Keras Framework</li>
                            <li>Setting Up Keras</li>
                            <li>Building Your First Model</li>
                            <li>Implementing Core Concepts in Keras: Gradient Descent and Classification</li>
                            <li>Summary</li>
                        </ul>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Resources:
                        </h4>
                        <div>
                            <a href="https://colab.research.google.com/drive/19JvSvXnrwv6w4tEIxYtPOChTKKSjB8i2?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                05-01-tensorflow-check
                            </a>
                            <a href="https://colab.research.google.com/drive/1ZQzMqpWVfCdqykYNOUzErA8l9frcRYjU?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                05-02-numpy
                            </a>
                            <a href="https://colab.research.google.com/drive/1OUOrxZvxSnermNrUlpX3jpMBxJBOQQMd?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                05-03-symbolic-computation
                            </a>

                            <a href="https://colab.research.google.com/drive/1NLtWgDK5OwjoBAnk6T-PwT9UE6OmzcoX?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                05-04-cats-dogs
                            </a>
                        </div>
                    </div>
                </div>
                <!-- Enf of Chapter  -->

                <!-- start of Chapter  -->
                <div class="chapter-item border border-gray-200 rounded-lg overflow-hidden">
                    <button
                        class="chapter-header w-full flex justify-between items-center p-4 bg-gray-50 hover:bg-gray-100 focus:outline-none text-left"
                        aria-expanded="false">
                        <span class="font-medium text-gray-700"><span class="mr-2 text-gray-500">6</span>
                            Regularization Techniques
                        </span>
                        <i class="fas fa-chevron-right chevron-icon text-gray-500"></i>
                    </button>
                    <div class="chapter-content bg-white">
                        <p class="text-gray-600 text-sm mb-4">
                            In this chapter, we will explore the critical challenge that every machine learning
                            practitioner faces: creating models that generalize well beyond their training data. We will
                            learn how to identify when our model is too complex or too simple. By the end of this
                            chapter, we will have acquired essential tools for building neural networks that capture
                            meaningful patterns without being led astray by noise in our training data.
                        </p>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Subsections:
                        </h4>
                        <ul class="list-disc list-inside text-sm text-gray-600 mb-4 space-y-1">
                            <li>An Overview of Overfitting and Underfitting: Do You Need More Data?</li>
                            <li>Dropout: Concept and Implementation</li>
                            <li>Other Regularization Methods: L1 and L2 Regularization, and When Not to Use Them</li>
                            <li>Applying Regularization in Keras</li>
                            <li>Summary</li>
                        </ul>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Resources:
                        </h4>
                        <div>
                            <a href="https://colab.research.google.com/drive/1jW5qtPN8DNDA5AzkJ5klFQqbrtFcKQIM?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                06-01-polynomial-features
                            </a>
                            <a href="https://colab.research.google.com/drive/1znJBB5R58SnkaG2WJqYgjFkrH8KV_m0S?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                06-02-dropout-scratch
                            </a>
                            <a href="https://colab.research.google.com/drive/1V_Bngnk_dXINsTT5wRtXuBzJGSpKVDub?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                06-03-keras-tuner
                            </a>

                            <!-- demo button -->
                            <a href="https://recluze.net/kb/06-polynomial-fit-demo.html" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-earth-asia notebook-icon"></i>
                                06-04-polynomial-fit-demo
                            </a>

                            <a href="https://colab.research.google.com/drive/1t03k-vm0kGEkWO_f-Mq62infpPRMK3m-?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                06-extra-01-plot-polynomials
                            </a>
                            <a href="https://colab.research.google.com/drive/1lTIl0OEJkAfGCAYFeKL52ckjnj48b_T6?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                06-extra-02-regularization-contours
                            </a>
                            <a href="https://colab.research.google.com/drive/1DhtwIfZzQ22Xm7G-z-IunuwFFDgFgGMq?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                06-extra-03-lambda-overfitting-underfitting
                            </a>



                        </div>
                    </div>
                </div>
                <!-- Enf of Chapter  -->

                <!-- start of Chapter  -->
                <div class="chapter-item border border-gray-200 rounded-lg overflow-hidden ">
                    <button
                        class="chapter-header w-full flex justify-between items-center p-4 bg-gray-50 hover:bg-gray-100 focus:outline-none text-left"
                        aria-expanded="false">
                        <span class="font-medium text-gray-700"><span class="mr-2 text-gray-500">7</span>
                            Convolutional Neural Networks (CNNs)
                        </span>
                        <i class="fas fa-chevron-right chevron-icon text-gray-500"></i>
                    </button>
                    <div class="chapter-content bg-white">
                        <p class="text-gray-600 text-sm mb-4">
                            In this chapter, we'll explore Convolutional Neural Networks and their revolutionary impact
                            on computer vision. We'll investigate how convolutional layers detect patterns while
                            minimizing parameters and we'll also explore some other types of commonly used layers.
                            Through our case study, you'll see how these components unite into a powerful image
                            classification system, gaining the intuition needed to design effective CNNs that process
                            visual information similar to our own visual systems.
                        </p>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Subsections:
                        </h4>
                        <ul class="list-disc list-inside text-sm text-gray-600 mb-4 space-y-1">
                            <li>Introduction to CNNs</li>
                            <li>Convolutional Layers, Pooling Layers and Fully Connected Layers</li>
                            <li>Implementing CNNs with Keras</li>
                            <li>The “Shapes” Problem</li>
                            <li>Case Study: Image Classification</li>
                            <li>Summary</li>
                        </ul>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Resources:
                        </h4>
                        <div>
                            <a href="https://colab.research.google.com/drive/1bRG0RytwbGZpz1HxD6iJSXHTFDXqA2g2?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                07-01-conv-basics
                            </a>
                            <a href="https://colab.research.google.com/drive/1kpN1CebfItnOr8b7igKO9uEUAU47v6aH?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                07-02-layer-types
                            </a>
                            <a href="https://colab.research.google.com/drive/1d48d3hC52i-4YOV2_XNHHYAD6wzj_ObW?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                07-03-shapes-mismatch
                            </a>
                            <a href="https://colab.research.google.com/drive/180ZrqE7PH-7HkWQtT6ggLcijQk3U-bzQ?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                07-04-image-classification
                            </a>

                            <!-- demo button -->
                            <a href="https://recluze.net/kb/07-05-conv-demo.html" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-earth-asia notebook-icon"></i>
                                07-05-conv-demo
                            </a>
                            <a href=https://recluze.net/kb/07-06-conv-3-channel-demo.html" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-earth-asia notebook-icon"></i>
                                07-06-conv-3-channel-demo
                            </a>

                        </div>
                    </div>
                </div>
                <!-- Enf of Chapter  -->

                <!-- start of Chapter  -->
                <div class="chapter-item border border-gray-200 rounded-lg overflow-hidden ">
                    <button
                        class="chapter-header w-full flex justify-between items-center p-4 bg-gray-50 hover:bg-gray-100 focus:outline-none text-left"
                        aria-expanded="false">
                        <span class="font-medium text-gray-700"><span class="mr-2 text-gray-500">8</span>
                            Exploring the Functional API of Keras
                        </span>
                        <i class="fas fa-chevron-right chevron-icon text-gray-500"></i>
                    </button>
                    <div class="chapter-content bg-white">
                        <p class="text-gray-600 text-sm mb-4">
                            In this chapter, we'll explore the Keras Functional API, moving beyond the limitations of
                            sequential models to build complex neural architectures with explicit layer connections.
                            We'll introduce powerful design patterns including residual networks with skip connections
                            and multi-branched models that process information along parallel pathways. Through
                            practical case studies, we'll implement cutting-edge applications like ResNet for
                            classification, Siamese Networks for similarity learning, and U-Net for image segmentation.
                            Finally, we'll master transfer learning, a technique that lets us repurpose pre-trained
                            models for specialized tasks with minimal data and computation. By the end, you'll
                            understand how the Functional API transforms Keras from a simple tool into a platform for
                            implementing sophisticated architectures that achieve superior performance across diverse
                            domains.
                        </p>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Subsections:
                        </h4>
                        <ul class="list-disc list-inside text-sm text-gray-600 mb-4 space-y-1">
                            <li>Overview of Keras Functional API</li>
                            <li>Building Complex Models with Functional API</li>
                            <li>Use Cases and Examples</li>
                            <li>Using Transfer Learning to Customize Models for Your Organization</li>
                            <li>Summary</li>

                        </ul>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Resources:
                        </h4>
                        <div>
                            <a href="https://colab.research.google.com/drive/18biM1SpwR9oqVYCfG8MWkMBr4lqgMtFo?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                08-01-residual-connections
                            </a>
                            <a href="https://colab.research.google.com/drive/1Tp4yz9T59w5khBbW2-AuupvGaz9RlPdt?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                08-02-siamese-network
                            </a>
                            <a href="https://colab.research.google.com/drive/1JMu0K6hjK77TObDICnv6FWnoqT_UVEj7?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                08-03-unet-segmentation
                            </a>
                            <a href="https://colab.research.google.com/drive/1DvJNSu4HNgSMdvZyIcVF4CiVwsVz6N6n?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                08-04-transfer-learning-intro
                            </a>
                            <a href="https://colab.research.google.com/drive/1kttSrt0kaiz-ZMkYU3URDv9py4ro49I_?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                08-05-transfer-learning-eurosat
                            </a>

                        </div>
                    </div>
                </div>
                <!-- Enf of Chapter  -->

                <!-- start of Chapter  -->
                <div class="chapter-item border border-gray-200 rounded-lg overflow-hidden ">
                    <button
                        class="chapter-header w-full flex justify-between items-center p-4 bg-gray-50 hover:bg-gray-100 focus:outline-none text-left"
                        aria-expanded="false">
                        <span class="font-medium text-gray-700"><span class="mr-2 text-gray-500">9</span>
                            Understanding Transformers
                        </span>
                        <i class="fas fa-chevron-right chevron-icon text-gray-500"></i>
                    </button>
                    <div class="chapter-content bg-white">
                        <p class="text-gray-600 text-sm mb-4">
                            In this chapter, we will explore transformers, a revolutionary architecture that has
                            redefined natural language processing. We'll begin with the theory behind how these models
                            understand relationships between words, regardless of their position in a sequence. We'll
                            learn about key components like attention mechanisms that make these models so effective.
                            We'll then build a transformer from scratch in Keras before showing you how to leverage
                            pre-trained models to create practical applications with minimal code. By the chapter's end,
                            you'll understand both transformer fundamentals and how to apply them to real-world
                            problems.
                        </p>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Subsections:
                        </h4>
                        <ul class="list-disc list-inside text-sm text-gray-600 mb-4 space-y-1">
                            <li>Theory Behind Transformers</li>
                            <li>Components: Attention Mechanism, Encoder, Decoder</li>
                            <li>Implementing Transformers in Keras</li>
                            <li>Case Study: Large Language Model Chatbot</li>
                            <li>Summary</li>

                        </ul>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Resources:
                        </h4>
                        <div>
                            <a href="https://colab.research.google.com/drive/1OCzMQr2drKwP9jTLyx9nmHAesxFVdIYy?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                09-01-timeseries-intro
                            </a>
                            <a href="https://colab.research.google.com/drive/18kkXOv6YdlPoY4mRB5BRWFzyY5Q2wYuF?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                09-02-glove-embedding
                            </a>
                            <a href="https://colab.research.google.com/drive/19tjx4ayIUjrL-6Q6JwuZXCenDoTUeBZV?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                09-03-transformer-basics
                            </a>
                            <a href="https://colab.research.google.com/drive/1fMMIY8EN_3SpKe1ZMbUU_SVzfyrcH3R4?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                09-04-transformer-case-study
                            </a>


                        </div>
                    </div>
                </div>
                <!-- Enf of Chapter  -->

                <!-- start of Chapter  -->
                <div class="chapter-item border border-gray-200 rounded-lg overflow-hidden ">
                    <button
                        class="chapter-header w-full flex justify-between items-center p-4 bg-gray-50 hover:bg-gray-100 focus:outline-none text-left"
                        aria-expanded="false">
                        <span class="font-medium text-gray-700"><span class="mr-2 text-gray-500">10</span>
                            Reinforcement Learning: The Secret Sauce
                        </span>
                        <i class="fas fa-chevron-right chevron-icon text-gray-500"></i>
                    </button>
                    <div class="chapter-content bg-white">
                        <p class="text-gray-600 text-sm mb-4">
                            In this chapter, we will explore how machines learn optimal decision-making through trial
                            and error. We'll examine the core concepts of agents, environments, and reward signals, and
                            introduce key algorithms including Q-learning, and Deep Q-Networks. Using Keras and
                            Gymnasium, we'll implement these techniques while balancing exploration and exploitation.
                            The chapter will highlight crucial innovations like experience replay and target networks
                            that have transformed reinforcement learning into a practical tool for complex problems.
                            We'll also connect these concepts to the large language models discussed in the previous
                            chapter, demonstrating how reinforcement learning techniques serves as a backbone for these
                            powerful systems.
                        </p>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Subsections:
                        </h4>
                        <ul class="list-disc list-inside text-sm text-gray-600 mb-4 space-y-1">
                            <li>Introduction to Reinforcement Learning</li>
                            <li>Key Concepts: Agents, Environments, Rewards</li>
                            <li>Popular Algorithms: Q-Learning, Policy Gradients, and DQN</li>
                            <li>Implementing Reinforcement Learning Models in Keras</li>
                            <li>Reinforcement Learning in Large Language Models</li>
                            <li>Summary</li>

                        </ul>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Resources:
                        </h4>
                        <div>
                            <a href="https://recluze.net/kb/10-01-q-learning-demo.html" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-earth-asia notebook-icon"></i>
                                10-01-q-learning-demo
                            </a>
                            <a href="https://drive.google.com/file/d/1Zx7fLL0wTXZ2S9SCM_z6glOQMIt0VZ9m/view?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                10-02-frozen-lake-q.py
                            </a>
                            <a href="https://colab.research.google.com/drive/1mIqJXxsQ8YWb2W5PoUzICsfzqRq1jhQ8?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                10-03-frozen-lake-dqn
                            </a>
                        </div>
                    </div>
                </div>
                <!-- Enf of Chapter  -->

                <!-- start of Chapter  -->
                <div class="chapter-item border border-gray-200 rounded-lg overflow-hidden ">
                    <button
                        class="chapter-header w-full flex justify-between items-center p-4 bg-gray-50 hover:bg-gray-100 focus:outline-none text-left"
                        aria-expanded="false">
                        <span class="font-medium text-gray-700"><span class="mr-2 text-gray-500">11</span>
                            Autoencoders and Generative AI
                        </span>
                        <i class="fas fa-chevron-right chevron-icon text-gray-500"></i>
                    </button>
                    <div class="chapter-content bg-white">
                        <p class="text-gray-600 text-sm mb-4">
                            In this chapter, we will explore generative AI models that create new data from learned
                            patterns, marking our transition from discriminative models that classify inputs to
                            generative models that produce outputs. Along with transformers, generative models represent
                            one of the most important technological foundations driving the current AI revolution,
                            enabling everything from artistic creation to data augmentation. We'll progress from
                            autoencoders through Variational Autoencoders to Generative Adversarial Networks, building
                            the foundation for understanding modern generative AI.
                        </p>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Subsections:
                        </h4>
                        <ul class="list-disc list-inside text-sm text-gray-600 mb-4 space-y-1">
                            <li>Introduction to Autoencoders</li>
                            <li>Variational Autoencoders (VAEs)</li>
                            <li>Generative Adversarial Networks (GANs)</li>
                            <li>Summary</li>

                        </ul>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Resources:
                        </h4>
                        <div>
                            <a href="https://colab.research.google.com/drive/15vR1HkmT-TE_uKMdtrvbx6ebpasJ-3ED?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                11-01-autoencoder-basics
                            </a>
                            <a href="https://colab.research.google.com/drive/1eyYFzQTXEjf5MyVSllSSL5FATfWMJ_q3?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                11-02-denoising-autoencoder
                            </a>
                            <a href="https://colab.research.google.com/drive/1axDaFskrKXKqLoJv6gqcsY5myHsKSf6Q?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                11-03-vaes
                            </a>
                            <a href="https://colab.research.google.com/drive/1Ktqin75f0jQREIBg4R8ylDudM19-YLOV?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                11-04-acgan-fashion-mnist
                            </a>
                        </div>
                    </div>
                </div>
                <!-- Enf of Chapter  -->


                <!-- start of Chapter  -->
                <div class="chapter-item border border-gray-200 rounded-lg overflow-hidden ">
                    <button
                        class="chapter-header w-full flex justify-between items-center p-4 bg-gray-50 hover:bg-gray-100 focus:outline-none text-left"
                        aria-expanded="false">
                        <span class="font-medium text-gray-700"><span class="mr-2 text-gray-500">12</span>
                            Advanced Generative AI: Stable Diffusion
                        </span>
                        <i class="fas fa-chevron-right chevron-icon text-gray-500"></i>
                    </button>
                    <div class="chapter-content bg-white">
                        <p class="text-gray-600 text-sm mb-4">
                            In this chapter, we'll tackle one of the most exciting frontiers in modern AI: Stable
                            Diffusion. You'll start by exploring the mathematics behind diffusion processes,
                            understanding how computers learn to transform random noise into visual art and build your
                            own diffusion model from scratch, watching it evolve from chaotic pixels to recognizable
                            images. You'll uncover the secret behind "Stable" Diffusion and explore text-conditioned
                            generation, where written words enable creative visual expression. Finally, you'll briefly
                            consider sophisticated techniques like inpainting, where you control image generation with
                            precision. By the end of this chapter, you'll understand how these systems work and how to
                            harness their power for your own projects.
                        </p>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Subsections:
                        </h4>
                        <ul class="list-disc list-inside text-sm text-gray-600 mb-4 space-y-1">
                            <li>Theory Behind Stable Diffusion </li>
                            <li>How Stable Diffusion Utilizes Core Concepts</li>
                            <li>Implementing Stable Diffusion Models</li>
                            <li>Case Study: Image Generation</li>
                            <li>Summary</li>

                        </ul>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Resources:
                        </h4>
                        <div>
                            <a href="https://colab.research.google.com/drive/1OB7dZUt5uqjkkcACvibU34fwezjjkfrG?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                12-01-diffusion-scratch
                            </a>
                            <a href="https://colab.research.google.com/drive/1E1KIMMlz7vZAvk8-YzP6lzGwARjy2G_z?usp=sharing" target="_blank" class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                12-02-prompt-based-images
                            </a>
                        </div>
                    </div>
                </div>
                <!-- Enf of Chapter  -->


                <!-- start of Chapter  -->
                <div class="chapter-item border border-gray-200 rounded-lg overflow-hidden ">
                    <button
                        class="chapter-header w-full flex justify-between items-center p-4 bg-gray-50 hover:bg-gray-100 focus:outline-none text-left"
                        aria-expanded="false">
                        <span class="font-medium text-gray-700"><span class="mr-2 text-gray-500">13</span>
                            Recap of Key Concepts
                        </span>
                        <i class="fas fa-chevron-right chevron-icon text-gray-500"></i>
                    </button>
                    <div class="chapter-content bg-white">
                        <p class="text-gray-600 text-sm mb-4">
                            This chapter serves as both a celebration of your learning journey and a compass for the
                            road ahead. We'll explore where deep learning is heading, discover practical strategies for
                            staying current with rapid developments in Keras and AI research, and develop skills for
                            following cutting-edge research. Most importantly, you'll gain the mindset and tools needed
                            to transform from a student of machine learning into a practitioner who can adapt and grow
                            alongside this quickly evolving field.
                        </p>
                        <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Subsections:
                        </h4>
                        <ul class="list-disc list-inside text-sm text-gray-600 mb-4 space-y-1">
                            <li>Future Trends in Deep Learning</li>
                            <li>Tips for Staying Updated with Advancements</li>
                            <li>Following the Latest Research</li>
                        </ul>
                        <!-- <h4 class="font-semibold text-gray-700 mb-2 text-sm">
                            Resources:
                        </h4>
                        <div>
                            <button class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                12-01-diffusion-scratch
                            </button>
                            <button class="action-button resource-button block w-full md:w-1/2">
                                <i class="fa-solid fa-laptop-code notebook-icon"></i>
                                12-02-prompt-based-images
                            </button>
                        </div> -->
                    </div>
                </div>
                <!-- Enf of Chapter  -->

            </div>
        </section>

        <!-- End of all chapters  -->


       
         
        <section class="p-6 pb-1 my-5 bg-white rounded-lg shadow-sm border border-gray-200">
            <h2 class="text-2xl font-semibold mb-4 text-gray-900 flex items-center">
                About the Author
            </h2>
            <div class="flex items-center space-x-4">
                <!-- <div class="w-16 h-16 bg-gray-300 rounded-full flex-shrink-0"></div> -->
                <div>
                    <h3 class="font-bold text-lg text-gray-800">
                        Dr. Mohammad Nauman
                    </h3>
                    <p class="text-sm text-gray-600 pb-3">
                        PhD in Computer Science, PostDoc in Machine Learning
                    </p>
                    <div class="text-sm text-gray-700 mt-1 about-author">
                        <p>
                            Dr. Mohammad Nauman (recluze) is a passionate
                            developer and educator with a deep love for
                            computer science. With a background in software
                            development and a strong commitment to making
                            complex concepts accessible, he has dedicated
                            his career to demystifying the world of computer
                            science and making it approachable for everyone.
                        </p>
                        <p>
                            As a technical writer and educator, recluze has
                            a unique perspective on the field, drawing from
                            his experiences in both development and
                            education. He is committed to helping others
                            understand and master the tools and concepts
                            that power the world.
                        </p>
                        <p>
                            You can find more about recluze and his work on
                            recluze.net and take a look at his video courses
                            on
                            <a href="https://recluze.net/learn">recluze.net/learn</a>.
                        </p>
                    </div>
                </div>
            </div>
        </section>


    </div>





    <footer style="text-align: center;" class="mb-5">
        <p>Connect with the Author</p>
        <div style="line-height: 2;">

            <i class="fab fa-youtube"></i>
            <a href="https://www.youtube.com/@recluze" target="_blank" style="margin-right: 1em;">recluze</a>

            <i class="fab fa-github"></i>
            <a href="https://github.com/recluze" target="_blank" style="margin-right: 1em;">recluze</a>

            <i class="fab fa-twitter"></i>
            <a href="https://twitter.com/recluze" target="_blank" style="margin-right: 1em;">recluze</a>


            <i class="fab fa-linkedin"></i>
            <a href="https://www.linkedin.com/in/recluze" target="_blank" style="margin-right: 1em;">recluze</a>

        </div>
    </footer>



    <script>
        // Get all chapter headers and content elements
        const chapterHeaders = document.querySelectorAll(".chapter-header");
        const chapterContents =
            document.querySelectorAll(".chapter-content");
        const expandAllBtn = document.getElementById("expandAllBtn");
        const chapterSearch = document.getElementById("chapterSearch");
        const tocList = document.getElementById("tocList");
        const chapterItems = tocList.querySelectorAll(".chapter-item"); // Get all chapter containers

        let allExpanded = false; // Track state for Expand All button

        // Function to toggle a single chapter
        function toggleChapter(header, content, icon) {
            const isOpen = header.getAttribute("aria-expanded") === "true";
            header.setAttribute("aria-expanded", !isOpen);
            content.classList.toggle("open");
            icon.classList.toggle("rotated");
            updateExpandAllButtonState(); // Update button text after individual toggle
        }

        // Add click listener to each chapter header
        chapterHeaders.forEach((header) => {
            const content = header.nextElementSibling; // The content div is the next sibling
            const icon = header.querySelector(".chevron-icon");

            if (content && icon) {
                header.addEventListener("click", () => {
                    toggleChapter(header, content, icon);
                });
            } else {
                console.error(
                    "Could not find content or icon for header:",
                    header,
                );
            }
        });

        // Function to update the Expand All button text and state
        function updateExpandAllButtonState() {
            // Filter only visible chapters when calculating state
            const visibleChapterItems = Array.from(chapterItems).filter(
                (item) => item.style.display !== "none",
            );
            const visibleChapterHeaders = visibleChapterItems.map((item) =>
                item.querySelector(".chapter-header"),
            );
            const openChapters = visibleChapterHeaders.filter(
                (header) => header.getAttribute("aria-expanded") === "true",
            ).length;
            const totalVisibleChapters = visibleChapterHeaders.length;

            // Handle case where no chapters are visible (due to search)
            if (totalVisibleChapters === 0) {
                expandAllBtn.textContent = "Expand All";
                allExpanded = false;
                expandAllBtn.disabled = true; // Optionally disable button
                return;
            }

            expandAllBtn.disabled = false; // Re-enable button if chapters are visible

            if (openChapters === totalVisibleChapters) {
                expandAllBtn.textContent = "Collapse All";
                allExpanded = true;
            } else {
                expandAllBtn.textContent = "Expand All";
                allExpanded = false;
            }
        }

        // Add click listener to the Expand All / Collapse All button
        expandAllBtn.addEventListener("click", () => {
            allExpanded = !allExpanded; // Toggle the state
            // Only toggle chapters that are currently visible (not filtered out by search)
            const visibleChapterItems = Array.from(chapterItems).filter(
                (item) => item.style.display !== "none",
            );

            visibleChapterItems.forEach((item) => {
                const header = item.querySelector(".chapter-header");
                const content = header.nextElementSibling;
                const icon = header.querySelector(".chevron-icon");
                const shouldBeOpen = allExpanded;
                const isCurrentlyOpen =
                    header.getAttribute("aria-expanded") === "true";

                if (content && icon && shouldBeOpen !== isCurrentlyOpen) {
                    header.setAttribute("aria-expanded", shouldBeOpen);
                    content.classList.toggle("open", shouldBeOpen);
                    icon.classList.toggle("rotated", shouldBeOpen);
                }
            });
            // Update button text immediately after action
            expandAllBtn.textContent = allExpanded
                ? "Collapse All"
                : "Expand All";
        });

        // Add input listener for the search functionality
        chapterSearch.addEventListener("input", (e) => {
            const searchTerm = e.target.value.toLowerCase();

            chapterItems.forEach((item) => {
                const header = item.querySelector(".chapter-header");
                const chapterTitle = header.textContent.toLowerCase();

                const content = header.nextElementSibling;
                const chapterContent = content.textContent.toLowerCase();

                const chapterText = chapterTitle + chapterContent;
                console.log(chapterText);

                // Check if the chapter title includes the search term
                if (chapterText.includes(searchTerm)) {
                    item.style.display = ""; // Show the chapter item
                } else {
                    item.style.display = "none"; // Hide the chapter item
                    // Optionally collapse hidden chapters when they are filtered out
                    // const content = header.nextElementSibling;
                    // const icon = header.querySelector('.chevron-icon');
                    // if (header.getAttribute('aria-expanded') === 'true') {
                    //     toggleChapter(header, content, icon);
                    // }
                }
            });
            // Update Expand All button state after filtering
            updateExpandAllButtonState();
        });

        // Initialize button state on load
        updateExpandAllButtonState();
    </script>
</body>

</html>
